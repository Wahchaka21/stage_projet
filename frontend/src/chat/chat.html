<div class="min-h-svh bg-gradient-to-b from-[#315f92] to-[#24476e]">

    <header class="sticky top-0 z-10 px-4 pt-4 pb-3 bg-gradient-to-b from-[#315f92] to-transparent">
        <div class="flex items-center justify-between text-white">
            <a routerLink="/accueil" class="rounded-full p-2 hover:bg-white/10 active:scale-95">
                <svg viewBox="0 0 24 24" class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M15 19l-7-7 7-7" />
                </svg>
            </a>

            <div class="flex-1 text-center">
                <p class="text-[11px] uppercase tracking-wide opacity-80">Discussion</p>
                <h1 class="text-base font-bold leading-tight">
                    {{ peerName() || 'Coach' }}
                </h1>
            </div>

            <button type="button" class="rounded-full p-2 hover:bg-white/10 active:scale-95">
                <svg viewBox="0 0 24 24" class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="1.5" />
                    <circle cx="6" cy="12" r="1.5" />
                    <circle cx="18" cy="12" r="1.5" />
                </svg>
            </button>
        </div>
    </header>

    <main class="-mt-2 rounded-t-3xl bg-white p-0">
        <div id="messages" class="h-[calc(100svh-220px)] overflow-y-auto px-3 py-4 sm:px-4">

            <div *ngFor="let m of messages; trackBy: trackByIdx" class="mb-3" [class.text-right]="m.me">
                <div class="text-[10px] text-gray-400 mb-0.5" [class.text-right]="m.me">
                    {{ m.at }}
                </div>

                <div class="inline-block max-w-[80%] rounded-2xl px-3 py-2 shadow-sm" [class.bg-[#315f92]]="m.me"
                    [class.text-white]="m.me" [class.rounded-br-sm]="m.me" [class.bg-[#e9eef7]]="!m.me"
                    [class.text-gray-900]="!m.me" [class.rounded-bl-sm]="!m.me">
                    <p class="text-[13px] leading-snug whitespace-pre-wrap break-words">
                        {{ m.text }}
                    </p>
                </div>
            </div>

            <div class="h-4"></div>
        </div>
    </main>

    <form (ngSubmit)="send()" class="fixed inset-x-0 bottom-0 z-20 mx-auto max-w-md px-4 pb-4">
        <div class="mx-auto flex items-center gap-2 rounded-full bg-white shadow-lg border border-gray-100 px-3 py-2.5">
            <button type="button" class="p-2 rounded-full hover:bg-gray-100 active:scale-95" title="Pièce jointe">
                <svg viewBox="0 0 24 24" class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15V8a5 5 0 0 0-10 0v9a3 3 0 1 0 6 0V9" />
                </svg>
            </button>

            <input [ngModel]="input()" (ngModelChange)="input.set($event)" name="msg"
                class="flex-1 bg-transparent outline-none text-[15px] placeholder:text-gray-400" autocomplete="off"
                placeholder="Écrire un message…" />

            <button type="submit"
                class="flex items-center gap-1 rounded-full bg-[#315f92] text-white text-sm px-3 py-2 active:scale-95 disabled:opacity-50"
                [disabled]="!input() || !input().trim()" title="Envoyer">
                <span class="hidden sm:inline">Envoyer</span>
                <svg viewBox="0 0 24 24" class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 2L11 13" />
                    <path d="M22 2l-7 20-4-9-9-4 20-7z" />
                </svg>
            </button>
        </div>
    </form>
</div>